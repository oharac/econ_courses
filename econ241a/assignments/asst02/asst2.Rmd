---
title: "Econ241a assignment 2"
author: "Casey O'Hara"
output:
  html_document:
    toc: yes
    number_sections: true
    toc_float: true
    code_folding: hide
  pdf_document:
    toc: no
---

``` {r setup, echo = FALSE, message = FALSE, warning = FALSE}

knitr::opts_chunk$set(fig.width = 6, fig.height = 4, fig.path = 'Figs/',
                      echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
```

# Suppose...

... that there are four types of potential research assistants. There are research
assistants who are productive and who make good comments in class; there are research
assistants who are productive but sit quietly; there are unproductive research assistants
who do make good comments and finally there are unproductive research assistants who
donâ€™t talk in class. The probabilities for the four kinds are

| Type              | probability $P$ |
|:----------------- |:---:|
| Productive, talks | .4  | 
| Productive, quiet | .2  | 
| Useless, talks    | .1  | 
| Useless, quiet    | .3  | 

Now suppose that the value of a productive RA is 1 and the value of an unproductive RA
is zero and that the cost of an RA is 0.7 and that you want to maximize

$$V = P(Prod) \times (1 - .7) + P(Unprod) \times (0 - .7)$$

### Should you hire an RA if all you know is the unconditional distribution?

If all we know is the unconditional distribution, then 

* $P(Prod) = .4 + .2 = .6$ and 
* $P(Unprod) = 1 - P(Prod) = .4$.  So:
    
    $$V = 0.6 \times 0.3 + 0.4 \times (-0.7) = -0.1$$
    
* Hiring an RA under the unconditional distribution results in more work for you.  Don't hire an RA.

### Suppose you now observe whether a student talks in class.

Now we can narrow down our sample set and consider:

* $P(Prod | talks) = P(Prod \cap talks)/P(talks) = 0.4 / 0.5 = 0.8$ and
* $P(Unprod | talks) = 1 - P(Prod | talks) = 0.2$.

$$V = 0.8 \times 0.3 + 0.2 \times (-0.7) = +0.1$$
* Hiring an RA knowing that this student talks in class provides positive value.  Give it a shot.

# Consider a health insurance plan...

If a person is sick, the plan will have to spend $C$. A healthy
person costs nothing. The probability that a young person will be sick is $p_y$; for an old
person $p_o$, where $p_o > p_y$. A fraction $f$ of the population is young. People voluntarily buy
insurance if the premium is equal to or below their expected cost of illness. The insurance
company prices the plan so as to break even.

### Suppose participation is mandatory. 

What will be the premium?

Under the mandatory insurance participation, the company can base their price on the average cost across the entire population.  

* $\mathbb{E} = P(sick) \times (premium - C) + P(healthy) \times (premium - 0) = 0$ (expect to break even)
    * $P(sick) = fp_y + (1 - f)p_o$
    * $P(healthy) = f(1 - p_y) + (1 - f)(1 - p_o)$
* After some algebra we get a per-person premium of:

$$premium = (fp_y + (1 - f)p_o)C$$

### Suppose participation is voluntary. 

What will be the premium?

Depending on the goal of the health insurance law, there could be several outcomes.

* If universal coverage is the goal, and tiered pricing is acceptable, then young people would pay $p_yC$ and old people would pay $p_oC$.
* If universal coverage is the goal, but a single premium is required, then you'd have to charge at the younger rate $p_yC$ and lose money (or get subsidies).
* Assuming universal coverage is not the goal, and a single premium is required, the break-even price would be at $p_oC$ and the young people would drop out of the market.

# Consider a test statistic...

Consider a test statistic that rejects a true null hypothesis a fraction $p = 0.05$ of the time.
Suppose we have $n = 20$ independent applications of this test. Draw a plot of the pdf of the
number of rejections (an application of the binomial distribution). What is the probability of
more than 1 rejection?

### Calculation

Consider this as a binomial distribution where "success" is "rejection".  The probability over all possible combinations sums to 1:

$$1 = \sum_{i=0}^n {n \choose i}p^i(1 - p)^{n - i}$$

Since we are interested in the case of more than 1 rejection, we can look at this as the probability of everything except 0 and 1 rejections, from a sample of 20 applications:

\begin{align*}
  P(i > 1) &= 1 - {n \choose 0}p^0(1 - p)^{n - 0} - {n \choose 1}p^1(1 - p)^{n - 1}\\
           &= 1 - {20 \choose 0} .05^0 .95^{20} - {20 \choose 1} .05^1 .95^{19}\\
           &= 1 - .3585 - .3774\\
           &= .2641
\end{align*}

### Plot pdf

``` {r plot_pdf}

n_attempts <- 20

df <- data.frame(rej = c(0:n_attempts)) %>%
  mutate(NchooseR = choose(n_attempts, rej),
         p = NchooseR * 0.05^rej * .95^(n_attempts - rej))

ggplot(df) +
  geom_histogram(aes(x = rej, y = p), stat = 'identity', 
                 fill = 'blue4', alpha = .7) +
  labs(x = 'Number of rejections (out of 20 trials)',
       y = 'Probability') +
  theme_bw() +
  theme(panel.border = element_blank())
```
